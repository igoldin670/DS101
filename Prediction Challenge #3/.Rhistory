print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# ---------------------------
# 4. Add Predicted Attribute to Training Dataset
# ---------------------------
# Add a new column with predictions on the training set
train_set$Predicted_Hired <- predict(rf_model, newdata = train_set)
# Optionally, you can inspect the first few rows to verify
head(train_set)
# Create a confusion matrix for training data
conf_matrix <- table(train_set$Predicted_Hired, train_set$Hired)
# Calculate accuracy: sum of diagonal values divided by total number of observations
accuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)
# Print the accuracy
print(paste("Training Set Accuracy:", round(accuracy * 100, 2), "%"))
# Read student data
student_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
student_data$University <- factor(student_data$University, levels = levels(train_set$University))
# Process the Major column: set levels to match training data
student_data$Major <- factor(student_data$Major, levels = levels(train_set$Major))
# Ensure GPA is numeric
student_data$GPA <- as.numeric(student_data$GPA)
# Now, predict using the trained random forest model
student_data$Predicted_Hired <- predict(rf_model, newdata = student_data)
# Write the submission to a CSV file
write.csv(submission, "submission.csv", row.names = FALSE)
# Load necessary libraries
library(randomForest)
library(caret)
library(dplyr)
# ---------------------------
# 1. Prepare Training Data
# ---------------------------
# Read training data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
# Convert columns to factors
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
# Split data into training (80%) and testing (20%) sets for evaluation
set.seed(123)  # for reproducibility
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
test_set  <- train_data[-train_index, ]
# Limit University factor levels to the top 52 most frequent universities;
# recode less frequent ones as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Apply the same transformation to the test set
test_set$University <- as.character(test_set$University)
test_set$University[!(test_set$University %in% top_univ)] <- "Other"
test_set$University <- factor(test_set$University)
# ---------------------------
# 2. Train the Model
# ---------------------------
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# ---------------------------
# 3. Evaluate the Model on Test Set
# ---------------------------
# Make predictions on the test set
predictions <- predict(rf_model, newdata = test_set)
# Create and print the confusion matrix
conf_mat <- confusionMatrix(predictions, test_set$Hired)
print(conf_mat)
# Calculate and print test accuracy
test_accuracy <- conf_mat$overall['Accuracy']
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# ---------------------------
# 4. Add Predicted Attribute to Training Dataset
# ---------------------------
# Add a new column with predictions on the training set
train_set$Predicted_Hired <- predict(rf_model, newdata = train_set)
# Optionally, you can inspect the first few rows to verify
head(train_set)
# Create a confusion matrix for training data
conf_matrix <- table(train_set$Predicted_Hired, train_set$Hired)
# Calculate accuracy: sum of diagonal values divided by total number of observations
accuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)
# Print the accuracy
print(paste("Training Set Accuracy:", round(accuracy * 100, 2), "%"))
# ---------------------------
# 5. Predict on Student Data and Export Submission
# ---------------------------
# Read student data
student_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
# Process the University column: recode to top 52 or "Other"
student_data$University <- as.character(student_data$University)
student_data$University[!(student_data$University %in% top_univ)] <- "Other"
student_data$University <- factor(student_data$University, levels = levels(train_set$University))
# Process the Major column: set levels to match training data
student_data$Major <- factor(student_data$Major, levels = levels(train_set$Major))
# Ensure GPA is numeric
student_data$GPA <- as.numeric(student_data$GPA)
# Predict using the trained random forest model
student_data$Predicted_Hired <- predict(rf_model, newdata = student_data)
# Write the entire student_data (including predictions) to a CSV file
write.csv(student_data, "submission.csv", row.names = FALSE)
# Load necessary libraries
library(randomForest)
library(caret)
library(dplyr)
# ---------------------------
# 1. Prepare Training Data
# ---------------------------
# Read training data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
# Convert columns to factors
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
# Split data into training (80%) and testing (20%) sets for evaluation
set.seed(123)  # for reproducibility
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
test_set  <- train_data[-train_index, ]
# Limit University factor levels to the top 52 most frequent universities;
# recode less frequent ones as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Apply the same transformation to the test set
test_set$University <- as.character(test_set$University)
test_set$University[!(test_set$University %in% top_univ)] <- "Other"
test_set$University <- factor(test_set$University)
# ---------------------------
# 2. Train the Model
# ---------------------------
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# ---------------------------
# 3. Evaluate the Model on Test Set
# ---------------------------
# Make predictions on the test set
predictions <- predict(rf_model, newdata = test_set)
# Create and print the confusion matrix
conf_mat <- confusionMatrix(predictions, test_set$Hired)
print(conf_mat)
# Calculate and print test accuracy
test_accuracy <- conf_mat$overall['Accuracy']
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# ---------------------------
# 4. Add Predicted Attribute to Training Dataset
# ---------------------------
# Add a new column with predictions on the training set
train_set$Predicted_Hired <- predict(rf_model, newdata = train_set)
# Optionally, you can inspect the first few rows to verify
head(train_set)
# Create a confusion matrix for training data
conf_matrix <- table(train_set$Predicted_Hired, train_set$Hired)
# Calculate accuracy: sum of diagonal values divided by total number of observations
accuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)
# Print the accuracy
print(paste("Training Set Accuracy:", round(accuracy * 100, 2), "%"))
# ---------------------------
# 5. Predict on Student Data and Export Submission
# ---------------------------
# Read student data
student_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
# Process the University column: recode to top 52 or "Other"
# Ensure University levels in student_data are consistent with training data
student_data$University <- as.character(student_data$University)
student_data$University[!(student_data$University %in% top_univ)] <- "Other"
student_data$University <- factor(student_data$University, levels = levels(train_set$University))
# Similar processing for Major, if needed
student_data$Major <- factor(student_data$Major, levels = levels(train_set$Major))
# Ensure GPA is numeric
student_data$GPA <- as.numeric(student_data$GPA)
# Predict using the trained random forest model
student_data$Predicted_Hired <- predict(rf_model, newdata = student_data)
# Write the entire student_data (including predictions) to a CSV file
write.csv(student_data, "submission.csv", row.names = FALSE)
# Load necessary libraries
library(randomForest)
library(caret)
library(dplyr)
# ---------------------------
# 1. Prepare Training Data
# ---------------------------
# Read training data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
# Convert columns to factors
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
# Split data into training (80%) and testing (20%) sets for evaluation
set.seed(123)  # for reproducibility
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
test_set  <- train_data[-train_index, ]
# Limit University factor levels to the top 52 most frequent universities;
# recode less frequent ones as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Apply the same transformation to the test set
test_set$University <- as.character(test_set$University)
test_set$University[!(test_set$University %in% top_univ)] <- "Other"
test_set$University <- factor(test_set$University)
# ---------------------------
# 2. Train the Model
# ---------------------------
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# ---------------------------
# 3. Evaluate the Model on Test Set
# ---------------------------
# Make predictions on the test set
predictions <- predict(rf_model, newdata = test_set)
# Create and print the confusion matrix
conf_mat <- confusionMatrix(predictions, test_set$Hired)
print(conf_mat)
# Calculate and print test accuracy
test_accuracy <- conf_mat$overall['Accuracy']
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# ---------------------------
# 4. Add Predicted Attribute to Training Dataset
# ---------------------------
# Add a new column with predictions on the training set
train_set$Predicted_Hired <- predict(rf_model, newdata = train_set)
# Optionally, you can inspect the first few rows to verify
head(train_set)
# Create a confusion matrix for training data
conf_matrix <- table(train_set$Predicted_Hired, train_set$Hired)
# Calculate accuracy: sum of diagonal values divided by total number of observations
accuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)
# Print the accuracy
print(paste("Training Set Accuracy:", round(accuracy * 100, 2), "%"))
# ---------------------------
# 5. Predict on Student Data and Export Submission
# ---------------------------
# Read student data
student_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
# Process the University column: recode to top 52 or "Other"
student_data$University <- as.character(student_data$University)
student_data$University[!(student_data$University %in% top_univ)] <- "Other"
student_data$University <- factor(student_data$University, levels = levels(train_set$University))
# Process the Major column: set levels to match training data
student_data$Major <- factor(student_data$Major, levels = levels(train_set$Major))
# Ensure GPA is numeric
student_data$GPA <- as.numeric(student_data$GPA)
# Predict using the trained random forest model
student_data$Predicted_Hired <- predict(rf_model, newdata = student_data)
# Replace any NA predictions with a random assignment (0 or 1)
na_indices <- which(is.na(student_data$Predicted_Hired))
if (length(na_indices) > 0) {
# Randomly assign 0 or 1 as character values.
student_data$Predicted_Hired[na_indices] <- sample(c("0", "1"), length(na_indices), replace = TRUE)
}
# Ensure Predicted_Hired is a factor (matching training levels)
student_data$Predicted_Hired <- factor(student_data$Predicted_Hired, levels = c("0", "1"))
# Create a submission data frame with only ID and Predicted_Hired
# (Assuming your student data has a column named "ID")
submission <- student_data[, c("ID", "Predicted_Hired")]
# Write the submission data frame to a CSV file
write.csv(submission, "submission.csv", row.names = FALSE)
library(randomForest)
library(caret)
library(dplyr)
# Prepare Training Data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
set.seed(123)
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
test_set  <- train_data[-train_index, ]
# Recode University column to top 52 universities, others as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
test_set$University <- as.character(test_set$University)
test_set$University[!(test_set$University %in% top_univ)] <- "Other"
test_set$University <- factor(test_set$University)
# Train the Model
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# Evaluate the Model on Test Set
predictions <- predict(rf_model, newdata = test_set)
conf_mat <- confusionMatrix(predictions, test_set$Hired)
print(conf_mat)
test_accuracy <- conf_mat$overall['Accuracy']
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# Add Predictions to Training Data (optional)
train_set$Predicted_Hired <- predict(rf_model, newdata = train_set)
head(train_set)
conf_matrix <- table(train_set$Predicted_Hired, train_set$Hired)
accuracy <- sum(diag(conf_matrix)) / sum(conf_matrix)
print(paste("Training Set Accuracy:", round(accuracy * 100, 2), "%"))
# Predict on Student Data and Export Submission
student_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
student_data$University <- as.character(student_data$University)
student_data$University[!(student_data$University %in% top_univ)] <- "Other"
student_data$University <- factor(student_data$University, levels = levels(train_set$University))
student_data$Major <- factor(student_data$Major, levels = levels(train_set$Major))
student_data$GPA <- as.numeric(student_data$GPA)
student_data$Predicted_Hired <- predict(rf_model, newdata = student_data)
na_indices <- which(is.na(student_data$Predicted_Hired))
if (length(na_indices) > 0) {
student_data$Predicted_Hired[na_indices] <- sample(c("0", "1"), length(na_indices), replace = TRUE)
}
student_data$Predicted_Hired <- factor(student_data$Predicted_Hired, levels = c("0", "1"))
submission <- student_data[, c("ID", "Predicted_Hired")]
write.csv(submission, "submission.csv", row.names = FALSE)
# Load necessary libraries
library(randomForest)
library(caret)
library(dplyr)
# ---------------------------
# 1. Prepare Training Data
# ---------------------------
# Read training data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
# Convert columns to factors
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
# Split data into training (80%) and testing (20%) sets for evaluation
set.seed(123)  # for reproducibility
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
test_set  <- train_data[-train_index, ]
# Limit University factor levels to the top 52 most frequent universities;
# recode less frequent ones as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Apply the same transformation to the test set
test_set$University <- as.character(test_set$University)
test_set$University[!(test_set$University %in% top_univ)] <- "Other"
test_set$University <- factor(test_set$University)
# ---------------------------
# 2. Train the Model
# ---------------------------
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# ---------------------------
# 3. Evaluate the Model on Test Set
# ---------------------------
# Make predictions on the test set
predictions <- predict(rf_model, newdata = test_set)
# Create and print the confusion matrix
conf_mat <- confusionMatrix(predictions, test_set$Hired)
print(conf_mat)
# Calculate and print test accuracy
test_accuracy <- conf_mat$overall['Accuracy']
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# ---------------------------
# 4. Add Predicted Attribute to Test Dataset
# ---------------------------
# Add a new column with predictions on the test set
test_set$Predicted_Hired <- predictions
# (Optional) Verify the predictions
head(test_set)
# Calculate accuracy by comparing predictions with actual values
accuracy <- mean(test_set$Predicted_Hired == test_set$Hired)
print(paste("Test Accuracy:", round(accuracy * 100, 2), "%"))
test_set
# Load necessary libraries
library(randomForest)
library(caret)
library(dplyr)
# ---------------------------
# 1. Prepare Training Data
# ---------------------------
# Read training data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
# Convert columns to factors
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
# Split data into training (80%) and testing (20%) sets for evaluation
set.seed(123)  # for reproducibility
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
test_set  <- train_data[-train_index, ]
# Limit University factor levels to the top 52 most frequent universities;
# recode less frequent ones as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Apply the same transformation to the test set
test_set$University <- as.character(test_set$University)
test_set$University[!(test_set$University %in% top_univ)] <- "Other"
test_set$University <- factor(test_set$University)
# ---------------------------
# 2. Train the Model
# ---------------------------
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# ---------------------------
# 3. Evaluate the Model on Test Set
# ---------------------------
# Make predictions on the test set
predictions <- predict(rf_model, newdata = test_set)
# Create and print the confusion matrix
conf_mat <- confusionMatrix(predictions, test_set$Hired)
print(conf_mat)
# Calculate and print test accuracy
test_accuracy <- conf_mat$overall['Accuracy']
print(paste("Test Set Accuracy:", round(test_accuracy * 100, 2), "%"))
# ---------------------------
# 4. Add Predicted Attribute to Test Dataset
# ---------------------------
# Add a new column with predictions on the test set
test_set$Predicted_Hired <- predictions
# (Optional) Verify the predictions
head(test_set)
# Calculate accuracy by comparing predictions with actual values
accuracy <- mean(test_set$Predicted_Hired == test_set$Hired)
print(paste("Test Accuracy:", round(accuracy * 100, 2), "%"))
library(randomForest)
library(caret)
library(dplyr)
# Prepare Training Data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
set.seed(123)
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
# Recode University factor to keep top 52 and label the rest as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Train the Random Forest Model
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# Load and Prepare Student Data for Prediction
students_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
students_data$Major <- as.factor(students_data$Major)
students_data$University <- as.character(students_data$University)
students_data$University[!(students_data$University %in% top_univ)] <- "Other"
students_data$University <- factor(students_data$University)
# Make Predictions on Student Data
predictions <- predict(rf_model, newdata = students_data)
# Replace NA predictions with a random choice between the available levels
na_indices <- which(is.na(predictions))
if(length(na_indices) > 0) {
predictions[na_indices] <- sample(levels(train_set$Hired), length(na_indices), replace = TRUE)
}
# Export predictions: create submission file with ID and Predicted_Hired columns
submission <- students_data %>%
select(ID) %>%
mutate(Predicted_Hired = predictions)
students_data
library(randomForest)
library(caret)
library(dplyr)
# Prepare Training Data
train_data <- read.csv("Prediction3Train.csv", stringsAsFactors = FALSE)
train_data$Major <- as.factor(train_data$Major)
train_data$University <- as.factor(train_data$University)
train_data$Hired <- as.factor(train_data$Hired)
set.seed(123)
train_index <- createDataPartition(train_data$Hired, p = 0.8, list = FALSE)
train_set <- train_data[train_index, ]
# Recode University factor to keep top 52 and label the rest as "Other"
train_set$University <- as.character(train_set$University)
univ_counts <- sort(table(train_set$University), decreasing = TRUE)
top_univ <- names(univ_counts)[1:52]
train_set$University[!(train_set$University %in% top_univ)] <- "Other"
train_set$University <- factor(train_set$University)
# Train the Random Forest Model
set.seed(123)
rf_model <- randomForest(Hired ~ GPA + Major + University, data = train_set, ntree = 100)
print(rf_model)
# Load and Prepare Student Data for Prediction
# Load and Prepare Student Data for Prediction
students_data <- read.csv("Prediction3Students.csv", stringsAsFactors = FALSE)
# Ensure 'Major' factor levels match training data
students_data$Major <- factor(students_data$Major, levels = levels(train_set$Major))
# Process 'University' similarly and recode values not in top_univ as "Other"
students_data$University <- as.character(students_data$University)
students_data$University[!(students_data$University %in% top_univ)] <- "Other"
students_data$University <- factor(students_data$University, levels = levels(train_set$University))
# Make Predictions on Student Data
predictions <- predict(rf_model, newdata = students_data)
# Replace NA predictions with a random choice between the available levels
na_indices <- which(is.na(predictions))
if(length(na_indices) > 0) {
predictions[na_indices] <- sample(levels(train_set$Hired), length(na_indices), replace = TRUE)
}
# Export predictions: create submission file with ID and Predicted_Hired columns
submission <- students_data %>%
select(ID) %>%
mutate(Predicted_Hired = predictions)
submission
students_data
